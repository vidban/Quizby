{% extends 'users/dashboard/dashboard.html' %}

{% block main %}
<div class="user-statistics">
	<div class="card col m-2">
		<div class="card-header">
			<h2>
				<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
					<path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
					<path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
				</svg>
				{{g.user.username}}
			</h2>
			<small>
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-event" viewBox="0 0 16 16">
					<path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>
					<path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
				</svg>
				Joined: {{ moment(g.user.date_joined).calendar()}}
			</small>
		</div>
		<div class="card-body">
			
		</div>
	</div>
	<div class="stats-user card col m-2">
		<div class="card-header">
			<ul id="user-statistics-tabs" class="nav nav-tabs card-header-tabs" role="tablist">
				<li class="nav-item">
				  	<a class="nav-link active" role="tab" aria-controls="status" aria-current="true" href="#status">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
							<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
							<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
						</svg>
						Status
					</a>
				</li>
				<li class="nav-item">
				  	<a class="nav-link" role="tab" aria-controls="quizscores" aria-current="false"  href="#quizscores">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart-line-fill" viewBox="0 0 16 16">
							<path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2z"/>
						</svg>
						Quiz Scores
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" role="tab" aria-controls="history" aria-current="false"  href="#history">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-archive-fill" viewBox="0 0 16 16">
							<path d="M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15h9.286zM5.5 7h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zM.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8H.8z"/>
						</svg>
						Quiz History
					</a>
				  </li>
			  </ul>
		</div>
		<div class="card-body">
			<div class="tab-content mt-3 col text-center">
				<div class="tab-pane active" id="status" role="tabpanel">
					<div class="d-flex flex-row flex-wrap">
						<div class="stats-questions card col-4 m-2">
							<div class="row g-0">
								<div class="card-header col-md-8">
									<h4>Questions Added</h4>
								</div>
								<div class="col-md-4 card-body">
									<p>{{g.user.questions|length}}</p>
								</div>
							</div>
						</div>
						<div class="stats-quizzes card col-4 m-2">
							<div class="row g-0">
								<div class="card-header col-md-8">
									<h4>Quizzes Added</h4>
								</div>
								<div class="col-md-4 card-body">
									<p>{{g.user.quizzes|length}}</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="tab-pane" id="quizscores" role="tabpanel">
					{% if g.user.activities and g.user.quizzes %}
						<h3>See scores for:</h3>
						{% for activity in g.user.activities|unique(attribute="quiz_id") %}
							<span class="hidden" id="chart-quiz-id">{{activity.quiz_id}}</span>
							<button id="chart-button" type="button" class="btn-outline-secondary">{{activity.quiz.title}}</button>
						{% endfor %}
						<div id="chart">
						</div>
					{% else %}
					<h5>No activity yet! </h5>
					{% endif %}
			
				</div>
				<div class="tab-pane" id="history" role="tabpanel">
					{% if g.user.activities %}
					<table class="history-table table table-hover table-striped">
						<thead><tr><th>Quiz Title</th><th>Date Taken</th><th>Score</th></tr></thead>
						<tbody>
							{% for activity in g.user.activities|sort(reverse=true,attribute="date_taken") %}
							<tr><td>{{activity.quiz.title}}</td><td>{{ moment(activity.date_taken).calendar()}}</td><td>{{activity.score}}</td></tr>
							{% endfor %}
						</tbody>
					</table>
					{% else %}
					<h5>No activity yet! </h5>
					{% endif %}
				</div>
			</div>
		</div>
	</div>
</div>



{% endblock%}